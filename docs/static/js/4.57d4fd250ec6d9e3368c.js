webpackJsonp([4],{"J+Lg":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("+6Bu"),n=a.n(r),i=a("Dd8w"),l=a.n(i),s=a("Xxa5"),d=a.n(s),c=a("exGp"),h=a.n(c),o=a("XLwt"),u=a("mtWM"),f=a.n(u),v=a("P0XF"),m={name:"Chart",data:function(){return{myChart:null,chartType:"sunburst",dataUrl:"static/data/data_6.json",data:{},dataCount:[],dataMenu:[],dataSelected:{},defaultProps:{children:"children",label:"name"},isMenuShow:!1,activeName:"旭日图",tabsList:[{label:"旭日图",name:"sunburst"},{label:"树形图",name:"tree"}],subfieldSelected:{}}},watch:{activeName:function(e){this.dataMenu=[],this.chartType=this.tabsList.find(function(t){return t.label===e}).name,this.initChart()}},mounted:function(){this.initChart()},methods:{initChart:function(){var e=this;return h()(d.a.mark(function t(){var a,r,n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=document.getElementById("chart"),e.myChart=o.b(a),e.myChart.showLoading(),t.next=5,f.a.get(e.dataUrl);case 5:r=t.sent,n=r.data,e.data=e.filterData(n),t.t0=e.chartType,t.next="sunburst"===t.t0?11:"tree"===t.t0?13:15;break;case 11:return e.initSunburst(),t.abrupt("break",15);case 13:return e.initTree(),t.abrupt("break",15);case 15:case"end":return t.stop()}},t,e)}))()},initSunburst:function(){this.myChart.clear(),this.isMenuShow=!1;var e={series:{type:"sunburst",data:this.filterLayerSunburst(this.data,2).children,nodeClick:!1,center:["50%","50%"],radius:["10%","80%"],sort:void 0,itemStyle:{borderWidth:2},label:{fontSize:12},emphasis:{focus:"ancestor"},levels:[{},{radius:["10%","40%"],label:{rotate:"tangential"}},{radius:["40%","80%"]}]}};this.myChart.setOption(e),this.myChart.hideLoading(),this.myChart.off("click"),this.myChart.on("click",this.handleSunburstClick)},initTree:function(){this.myChart.clear();var e=this.filterLayerTree(this.data,2),t=o.a,a={tooltip:{trigger:"item",triggerOn:"mousemove",formatter:function(e){for(var a=e.treeAncestors,r=[],n=1;n<a.length;n++)r.push(a[n].name);return['<div class="tooltip-title">'+t.encodeHTML(r.join(" > "))+"</div>"].join("")}},series:{type:"tree",data:[e],roam:!0,top:"1%",left:"7%",bottom:"1%",right:"20%",symbolSize:7,label:{position:"left",verticalAlign:"middle",align:"right",fontSize:9},leaves:{label:{position:"right",verticalAlign:"middle",align:"left"}},emphasis:{focus:"relative"},expandAndCollapse:!0,animationDuration:550,animationDurationUpdate:750}};this.myChart.setOption(a),this.myChart.hideLoading(),this.myChart.off("click"),this.myChart.on("click",this.handleTreeClick)},handleSunburstClick:function(e){var t=e.treePathInfo,a=e.data,r=360/t[0].value*(a.layerIndex-.5);if(a.isLeaf){this.dataMenu=[],this.dataSelected={};var n=this.filterLayerSunburst(this.data,2,a);this.isMenuShow=this.dataMenu.length>0;var i={};i=this.isMenuShow?{center:["25%","50%"],radius:["0","70%"],label:{fontSize:10},levels:[{},{radius:["5%","25%"],label:{rotate:"tangential"}},{radius:["25%","60%"]}]}:{center:["50%","50%"],radius:["0","80%"],label:{fontSize:12},levels:[{},{radius:["10%","40%"],label:{rotate:"tangential"}},{radius:["40%","80%"]}]},this.myChart.setOption({series:l()({},i,{startAngle:r,data:n.children})})}},handleTreeClick:function(e){var t=this,a=this.myChart.getOption(),r=this.myChart.getOption().series[0].data[0],n=e.treeAncestors,i=e.data;if(n&&n.length>0){var s=l()({},r);n.forEach(function(e,a){s=i.children&&i.children.length>0?t.handleItemCollapsed(s,e.name,a,n.length):t.handleItemSelected(s,e.name,a,i.selected)}),a.series[0].data=[s],this.myChart.clear(),this.myChart.setOption(a)}},handleLayerItemClick:function(e){e.children&&e.children.length>0?this.dataSelected=e:this.dataSelected={}},handleSubfieldMouseenter:function(e){this.subfieldSelected=e},handleLeafSelected:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];if(r){var i=e.children,s=e.chartId,d=e.chartLayer,c=n()(e,["children","chartId","chartLayer"]),h=a.chartId,o=l()({},c,{chartLayer:d,chartId:s});return d<r?i&&i.length>0&&(o.children=i.map(function(e){return t.filterLayerSunburst(e,r)})):h===s&&(o.value=1,o.isLeaf=!0),h===s?o.itemStyle={color:"#004e9f"}:d<r&&(o.children=i&&i.map(function(e){return t.handleLeafSelected(e,a)})),o}return e},handleItemCollapsed:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],a=this,r=arguments[2],i=arguments[3],s=e.children,d=void 0===s?[]:s,c=e.name,h=e.chartLayer,o=n()(e,["children","name","chartLayer"]),u=l()({name:c,chartLayer:h},o,{children:d&&d.map(function(e){return a.handleItemCollapsed(e,t,r,i)})});return r===h+1&&(u.selected||(u.collapsed=i===r+1?c!==t||!u.collapsed:c!==t)),u},handleItemSelected:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],a=this,r=arguments[2],i=arguments[3],s=e.children,d=void 0===s?[]:s,c=e.name,h=e.chartLayer,o=n()(e,["children","name","chartLayer"]),u=l()({name:c,chartLayer:h},o,{children:d&&d.map(function(e){return a.handleItemSelected(e,t,r,i)})});return r===h+1&&t===c&&(i?(u.selected=!1,u.lineStyle={},u.label={}):(u.selected=!0,u.lineStyle={color:"#38ab00"},u.label={color:"#004e9f",fontWeight:"bold",fontSize:12,backgroundColor:"#fff"})),u},onPopoverHide:function(e){e.chartId===this.dataSelected.chartId&&(this.dataSelected={})},filterData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t.name,n=void 0===r?"":r,i=t.children,l=void 0===i?[]:i,s=t.procedureId,d=t.menuType;this.dataCount[a]=this.dataCount[a]?this.dataCount[a]+1:1;var c=this.dataCount[a];return{name:n.replace("<br>","\n"),chartId:"chart-"+Object(v.a)(),chartLayer:a,layerIndex:c,menuType:d,procedureId:s,children:l&&l.map(function(t){return e.filterData(t,a+1)})}},filterLayerSunburst:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,a=arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(a){var i=e.children,s=void 0===i?[]:i,d=e.chartLayer,c=n()(e,["children","chartLayer"]),h=l()({},c,{chartLayer:d});return d<a?s&&s.length>0&&(h.children=s.map(function(e){return t.filterLayerSunburst(e,a,r)})):(h.value=1,h.isLeaf=!0,h.procedureId&&(h.label={position:"outside",padding:3,silent:!1}),r&&r.chartId===h.chartId&&(h.itemStyle={color:"#004e9f"},s&&s.length>0&&(this.dataMenu=[l()({},h,{children:s&&s.map(function(e){return t.filterLayerSunburst(e,100)})})],this.subfieldSelected=s.find(function(e){return e.children&&e.children.length>0})))),h}return e},filterLayerTree:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments[1];if(a){var r=t.children,i=void 0===r?[]:r,s=t.chartLayer,d=n()(t,["children","chartLayer"]);return l()({},d,{collapsed:s>=a,chartLayer:s,children:i&&i.map(function(t){return e.filterLayerTree(t,a)})})}return t}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"layout-flex column"},[a("div",{staticClass:"layout-flex-s pb-xs"},[a("div",{staticClass:"layout-flex"},[a("div",{staticClass:"layout-flex-s"},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabsList,function(t){return a("el-radio-button",{key:t.name,attrs:{label:t.label}},[e._v("\n            "+e._s(t.label)+"\n          ")])}),1)],1)])]),e._v(" "),a("div",{staticClass:"layout-flex-l chart-wrapper"},["sunburst"===e.chartType?a("div",{staticClass:"chart-menu layered",class:{show:e.isMenuShow}},[a("div",{staticClass:"menu-content"},e._l(e.dataMenu,function(t){return a("div",{key:"p-"+t.chartId,staticClass:"layered-content layout-flex column"},[a("div",{staticClass:"layered-name layout-flex-s"},[e._v(e._s(t.name))]),e._v(" "),"subfield"===t.menuType?a("div",{staticClass:"layout-subfield layout-flex-l"},[a("div",{staticClass:"layout-subfield-item"},e._l(t.children,function(t){return a("div",{key:t.chartId,staticClass:"layout-subfield-name",class:{active:t.chartId===e.subfieldSelected.chartId},on:{mouseenter:function(a){return e.handleSubfieldMouseenter(t)}}},[e._v(e._s(t.name))])}),0),e._v(" "),e.subfieldSelected.chartId?a("div",{staticClass:"layout-subfield-menu"},[e._l(t.children,function(t){return[t.chartId===e.subfieldSelected.chartId?a("div",{key:t.chartId,staticClass:"layered-list"},[e._l(t.children,function(t){return a("div",{key:t.chartId,staticClass:"layered-item",class:{"has-child":t.children&&t.children.length>0,active:t.chartId===e.dataSelected.chartId},on:{mouseenter:function(a){return e.handleLayerItemClick(t)}}},[a("el-popover",{ref:"popover",refInFor:!0,attrs:{disabled:!(t.children&&t.children.length>0),"popper-class":"layered-popover",placement:"right",trigger:"hover"},on:{hide:function(a){return e.onPopoverHide(t)}}},[a("div",{staticClass:"chart-menu-tree"},[t.children&&t.children.length>0?a("el-tree",{attrs:{data:[t],props:e.defaultProps,indent:0,"default-expand-all":""}}):e._e()],1),e._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[t.children&&t.children.length>0?a("i",{staticClass:"el-icon-arrow-right"}):e._e(),e._v("\n                        "+e._s(t.name)+"\n                      ")])])],1)}),e._v(" "),t.children&&0!==t.children.length?e._e():a("div",{staticClass:"layered-empty"},[a("div",{staticClass:"layered-empty-text"},[e._v("暂无数据")])])],2):e._e()]})],2):e._e()]):a("div",{staticClass:"layered-list layout-flex-l"},e._l(t.children,function(t){return a("div",{key:t.chartId,staticClass:"layered-item",class:{"has-child":t.children&&t.children.length>0,active:t.chartId===e.dataSelected.chartId},on:{mouseenter:function(a){return e.handleLayerItemClick(t)}}},[a("el-popover",{ref:"popover",refInFor:!0,attrs:{disabled:!(t.children&&t.children.length>0),"popper-class":"layered-popover",placement:"right",trigger:"hover"},on:{hide:function(a){return e.onPopoverHide(t)}}},[a("div",{staticClass:"chart-menu-tree"},[t.children&&t.children.length>0?a("el-tree",{attrs:{data:[t],props:e.defaultProps,indent:0,"default-expand-all":""}}):e._e()],1),e._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[t.children&&t.children.length>0?a("i",{staticClass:"el-icon-arrow-right"}):e._e(),e._v("\n                  "+e._s(t.name)+"\n                ")])])],1)}),0)])}),0)]):e._e(),e._v(" "),a("div",{staticClass:"chart",attrs:{id:"chart"}})])])},staticRenderFns:[]},p=a("VU/8")(m,y,!1,null,null,null);t.default=p.exports}});
//# sourceMappingURL=4.57d4fd250ec6d9e3368c.js.map