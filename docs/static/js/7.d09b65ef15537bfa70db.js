webpackJsonp([7],{ReYc:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),n=a.n(r),i=a("Xxa5"),l=a.n(i),d=a("+6Bu"),c=a.n(d),h=a("exGp"),s=a.n(h),o=a("XLwt"),u=a("mtWM"),f=a.n(u),v=a("P0XF"),y={name:"Chart",data:function(){return{myChart:null,dataUrl:"static/data/data_3.json",data:{},dataPath:[],dataCount:[],dataMenu:[],dataSelected:{},defaultProps:{children:"children",label:"name"},isMenuShow:!1,isFilterStop:!1,activeName:"党群工作部",tabsList:[{label:"党群工作部",name:"1",url:"static/data/data_1.json"},{label:"整体管理",name:"2",url:"static/data/data_2.json"},{label:"公司地图",name:"3",url:"static/data/data_3.json"}]}},watch:{activeName:function(t){this.dataUrl=this.tabsList.find(function(e){return e.label===t}).url,this.initChart()}},mounted:function(){this.initChart()},methods:{initChart:function(){var t=this;return s()(l.a.mark(function e(){var a,r,n,i,d,h;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=document.getElementById("chart"),t.myChart=o.b(a),t.myChart.showLoading(),e.next=5,f.a.get(t.dataUrl);case 5:r=e.sent,n=r.data,t.data=t.filterData(n),i=t.filterLayer(t.data,2),i.children,d=c()(i,["children"]),t.dataPath=[d],h={series:{type:"sunburst",data:i.children,nodeClick:!1,center:["50%","50%"],radius:["10%","80%"],sort:void 0,itemStyle:{borderWidth:2},label:{fontSize:12},emphasis:{focus:"ancestor"},levels:[{},{radius:["10%","40%"],label:{rotate:"tangential"}},{radius:["40%","80%"]}]}},t.myChart.setOption(h),t.myChart.on("click",t.handleChartClick),t.myChart.hideLoading();case 15:case"end":return e.stop()}},e,t)}))()},handleChartClick:function(t){var e=t.treePathInfo,a=t.data,r=360/e[0].value*(a.layerIndex-.5);if(a.isLeaf){this.dataMenu=[],this.dataSelected={};var i=this.filterLayer(this.data,2,a);this.isMenuShow=this.dataMenu.length>0;var l={};l=this.isMenuShow?{center:["25%","50%"]}:{center:["50%","50%"]},this.myChart.setOption({series:n()({},l,{startAngle:r,data:i.children})})}},handleCrumbsClick:function(t){var e=t.chartId,a=this.filterTarget(this.data,e),r=this.dataPath.findIndex(function(t){return t.chartId===e});if(r===this.dataPath.length-1)return!1;if(a){var n=a.children;n&&n.length>0&&(this.dataPath=this.dataPath.slice(0,r+1),this.setChartByTarget(a))}},handleLayerItemClick:function(t){t.children&&t.children.length>0?this.dataSelected=t:this.dataSelected={}},onPopoverHide:function(t){t.chartId===this.dataSelected.chartId&&(this.dataSelected={})},setChartByTarget:function(t){var e=t.chartLayer,a=this.filterLayer(t,e+2);this.myChart.setOption({series:{data:a.children}})},filterData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.name,n=void 0===r?"":r,i=e.children,l=void 0===i?[]:i,d=e.procedureId;this.dataCount[a]=this.dataCount[a]?this.dataCount[a]+1:1;var c=this.dataCount[a],h={name:n.replace("<br>","\n"),chartId:"chart-"+Object(v.a)(),chartLayer:a,layerIndex:c,procedureId:d,children:l&&l.map(function(e){return t.filterData(e,a+1)})};return l&&0===l.length&&d&&(h.value=1,h.label={position:"outside",padding:3,silent:!1}),h},filterLayer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,a=arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(a){var i=t.children,l=void 0===i?[]:i,d=t.chartLayer,h=c()(t,["children","chartLayer"]),s=n()({},h,{chartLayer:d});return d<a?l&&l.length>0&&(s.children=l.map(function(t){return e.filterLayer(t,a,r)})):(s.value=1,s.isLeaf=!0,s.procedureId&&(s.label={position:"outside",padding:3,silent:!1}),r&&r.chartId===s.chartId&&(s.itemStyle={color:"#004e9f"},l&&l.length>0&&(this.dataMenu=[n()({},s,{children:l&&l.map(function(t){return e.filterLayer(t,100)})})]))),s}return t},filterTarget:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments[1],r=e.children,i=void 0===r?[]:r,l=null;return e.chartId===a?l=n()({},e):i&&i.forEach(function(e){var r=t.filterTarget(e,a);r&&(l=r)}),l},handleLeafSelected:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];if(r){var i=t.children,l=t.chartId,d=t.chartLayer,h=c()(t,["children","chartId","chartLayer"]),s=a.chartId,o=n()({},h,{chartLayer:d,chartId:l});return d<r?i&&i.length>0&&(o.children=i.map(function(t){return e.filterLayer(t,r)})):s===l&&(o.value=1,o.isLeaf=!0),s===l?o.itemStyle={color:"#004e9f"}:d<r&&(o.children=i&&i.map(function(t){return e.handleLeafSelected(t,a)})),o}return t},getChildren:function(t,e){var a=!1,r=null;return function t(n){Array.isArray(n)&&!a&&n.forEach(function(n){n.chartLayer===e?(r=n,a=!0):n.children&&t(n.children)})}(t),r}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"layout-flex column"},[a("div",{staticClass:"layout-flex-l chart-wrapper"},[a("div",{staticClass:"chart-menu layered",class:{show:t.isMenuShow}},[a("div",{staticClass:"menu-content"},t._l(t.dataMenu,function(e){return a("div",{key:"p-"+e.chartId,staticClass:"layered-content layout-flex column"},[a("div",{staticClass:"layered-name layout-flex-s"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"layered-list layout-flex-l"},t._l(e.children,function(e){return a("div",{key:e.chartId,staticClass:"layered-item",class:{"has-child":e.children&&e.children.length>0,active:e.chartId===t.dataSelected.chartId},on:{mouseenter:function(a){return t.handleLayerItemClick(e)}}},[a("el-popover",{ref:"popover",refInFor:!0,attrs:{disabled:!(e.children&&e.children.length>0),"popper-class":"layered-popover",placement:"right",trigger:"hover"},on:{hide:function(a){return t.onPopoverHide(e)}}},[a("div",{staticClass:"chart-menu-tree"},[e.children&&e.children.length>0?a("el-tree",{attrs:{data:[e],props:t.defaultProps,indent:0,"default-expand-all":""}}):t._e()],1),t._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[e.children&&e.children.length>0?a("i",{staticClass:"el-icon-arrow-right"}):t._e(),t._v("\n                  "+t._s(e.name)+"\n                ")])])],1)}),0)])}),0)]),t._v(" "),a("div",{staticClass:"chart",attrs:{id:"chart"}})])])},staticRenderFns:[]},p=a("VU/8")(y,m,!1,null,null,null);e.default=p.exports}});
//# sourceMappingURL=7.d09b65ef15537bfa70db.js.map